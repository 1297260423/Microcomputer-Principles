# 中断的一般概念



> 中断是指在突发事件到来时先中止当前正在进行的工作，转而去处理突发事件。待处理完成后，再返回到原先被中止的工作处，继续进行随后的工作。 



**中断响应过程**：由中断管理系统处理突发事件的过程；

**中断源**：中断管理系统能够处理的突发事件;

**中断请求**：中断源向CPU提出的处理请求;

**中断函数**：针对中断源和中断请求提供的服务函数;

**中断嵌套**：在中断服务过程中执行更高级别的中断服务。



中断过程与调用一般函数过程的**相似性**: 两者都需要保护断点，都可实现多级嵌套等。

中断过程与调用一般函数过程的**差异性**:

1. 前者是程序设计者事先安排的（断点位置是明确的），而后者却是系统根据工作环境随机决定的（断点位置是随机的）。

2. 主函数与一般函数之间具有主从关系，而主函数与中断函数之间则是平行关系（中断函数只能被系统调用）；
3. 一般函数调用是纯粹软件处理过程，而中断函数调用却是需要软、硬件配合才能完成的过程。



#### 中断实现的功能：

1. **分时操作**：CPU可以使多个外设同时工作，并分时为各外设提供服务，从而大大提高了CPU的利用率和输入/输出的速度。
2. **实时处理**：当计算机用于实时控制时，请求CPU提供服务是随机发生的。有了中断系统，CPU就可以立即响应并加以处理。
3. **故障处理**：当计算机运行中出现如电源断电、存储器校验出错、运算溢出等错误时，CPU可及时转去执行故障处理程序，减小或消除故障产生的影响。

#### 优先级原则：

1. 高级中断请求可以打断正在执行的低级中断；
2. 同级或低级中断请求不能打断正在执行的中断；
3. 同级中断源同时提出请求时按自然优先级响应：

#### 中断处理过程
中断处理包括中断请求、中断响应、中断服务、中断返回等环节。

1、中断响应

  CPU响应中断的基本条件为：
（1）有中断源发出中断请求；
（2）中断总允许位EA=1，即CPU开中断；
（3）申请中断的中断源的中断允许位为1。

CPU响应中断后的操作过程：
1.中断优先级查询，阻止后来的同级或低级中断请求。
2.保护断点，即把程序计数器PC的内容压入堆栈保存。
3.清除中断请求标志位。
4.调用中断函数并开始运行。
5.返回断点继续运行。
【注意】除中断函数运行是软件方式外，其余中断处理过程都是由单片机硬件自动完成的。


2、响应时间
Ø从查询中断请求标志到执行中断函数第一条语句所经历的时间，称为中断响应时间。
ØCPU在每个机器周期的S6期间查询每个中断请求的标志位。
Ø中断响应时间 = 1个查询机器周期 + 2个调用中断函数周期= 3个机器周期，这也是对中断请求做出响应所需的最短时间。


3、中断撤销
1.定时/计数器中断：硬件自动撤销
2.外部中断：脉冲触发：自动
3.电平触发：外加电路
4.串口中断：软件撤销

4、中断服务函数
C51中断函数的声明格式：
void  函数名 (void)   interrupt n [using m]
interrupt n，表示是关于中断源n的中断服务函数；
using m，表示该中断函数将使用第m组工作寄存器。缺省为当前工作寄存器组。
【注意】1、中断服务函数既没有返回值，也没有调用参数； 2、中断服务函数只能由系统调用，不能被其他函数调用。
————————————————

> >版权声明：本文为CSDN博主「朽木自雕i」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
> 原文链接：https://blog.csdn.net/qq_45385706/article/details/112104779